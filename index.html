<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEXUS CORE v8.5</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com">
    
    <!-- FIREBASE COMPAT (CDN Cloudflare plus robuste) -->
    <script src="https://cdnjs.cloudflare.com"></script>
    <script src="https://cdnjs.cloudflare.com"></script>

    <style>
        :root { --matrix-green: #00FF41; --bg-dark: #020502; }
        body { background-color: var(--bg-dark); color: var(--matrix-green); font-family: monospace; margin: 0; overflow: hidden; height: 100vh; }
        .bento-hybrid { background: rgba(0, 20, 0, 0.8); backdrop-filter: blur(15px); border: 1px solid rgba(0, 255, 65, 0.2); border-radius: 20px; position: relative; z-index: 10; }
        #matrix-canvas { position: fixed; top: 0; left: 0; z-index: 0; opacity: 0.15; }
        .radar-container { width: 120px; height: 120px; border: 1px solid var(--matrix-green); border-radius: 50%; position: relative; overflow: hidden; }
        .radar-hand { position: absolute; width: 50%; height: 1px; background: var(--matrix-green); top: 50%; left: 50%; transform-origin: left; animation: sweep 4s linear infinite; }
        @keyframes sweep { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
    </style>
</head>

<body class="p-4 flex flex-col h-screen">
    <canvas id="matrix-canvas"></canvas>

    <!-- HEADER -->
    <header class="flex justify-between items-center mb-4 relative z-50">
        <div>
            <h1 class="text-xl font-bold text-white">NEXUS<span class="text-green-500">.CORE</span></h1>
            <p id="system-clock" class="text-[10px] opacity-60">21 JANVIER 2026 // --:--:--</p>
        </div>
        <div class="text-right text-[10px]">
            <p>LOC: <span id="header-loc" class="text-white">SCANNING...</span></p>
            <p id="ip-external" class="text-green-500">0.0.0.0</p>
        </div>
    </header>

    <!-- GRID -->
    <main class="grid grid-cols-12 gap-4 flex-1 overflow-hidden relative z-10">
        <div class="col-span-12 md:col-span-4 bento-hybrid p-4 flex flex-col items-center justify-center">
            <div class="radar-container"><div class="radar-hand"></div></div>
            <p id="geo-city" class="text-[10px] mt-2 uppercase">Connecting...</p>
        </div>

        <div class="col-span-12 md:col-span-8 bento-hybrid p-4">
            <h3 class="text-[10px] uppercase mb-2">Cloud_FileSystem</h3>
            <div id="file-list" class="space-y-1 h-32 overflow-y-auto text-[11px]">
                <p class="opacity-30 italic">Initialisation liaison...</p>
            </div>
        </div>

        <div class="col-span-12 bento-hybrid p-4 grid grid-cols-3 gap-4">
            <div><p class="text-[9px] opacity-50">CPU_LOAD</p><p id="cpu-usage" class="text-2xl font-bold">--%</p></div>
            <div><p class="text-[9px] opacity-50">CORES</p><p id="cpu-cores" class="text-2xl font-bold">--</p></div>
            <div><p class="text-[9px] opacity-50">MEM_JS</p><p id="stat-heap" class="text-2xl font-bold">-- MB</p></div>
        </div>
    </main>

    <!-- TERMINAL -->
    <footer class="mt-4 bento-hybrid p-3 h-24 overflow-hidden relative z-50">
        <div id="real-console-logs" class="text-[10px] font-mono leading-tight"></div>
    </footer>

    <script>
        // 1. LOGGER VISUEL (Indépendant)
        function screenLog(msg, color="#00FF41") {
            const logger = document.getElementById('real-console-logs');
            if(logger) {
                logger.innerHTML += `<p style="color:${color}">> ${msg}</p>`;
                if(logger.childNodes.length > 5) logger.removeChild(logger.firstChild);
            }
        }

        // 2. MATRIX (Indépendant)
        function initMatrix() {
            const canvas = document.getElementById('matrix-canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth; canvas.height = window.innerHeight;
            const drops = Array(Math.floor(canvas.width/16)).fill(1);
            setInterval(() => {
                ctx.fillStyle = "rgba(2, 5, 2, 0.1)"; ctx.fillRect(0,0,canvas.width, canvas.height);
                ctx.fillStyle = "#00FF41"; ctx.font = "15px monospace";
                drops.forEach((y, i) => {
                    ctx.fillText(Math.floor(Math.random()*2), i*16, y*16);
                    if(y*16 > canvas.height && Math.random() > 0.975) drops[i] = 0;
                    drops[i]++;
                });
            }, 50);
        }

        // 3. FIREBASE (Indépendant avec Try/Catch)
        function initFirebase() {
            if (typeof firebase === 'undefined') {
                screenLog("FIREBASE_ENGINE_RETRY...", "#FFA500");
                setTimeout(initFirebase, 2000);
                return;
            }

            try {
                const config = {
                    apiKey: "AIzaSyAISsXH1mIvoPbIKKtiFCsGg26bfn6mhrI",
                    authDomain: "nexus-core-bfe3a.firebaseapp.com",
                    projectId: "nexus-core-bfe3a",
                    storageBucket: "nexus-core-bfe3a.firebasestorage.app",
                    messagingSenderId: "823704172120",
                    appId: "1:823704172120:web:2cdc9171ea3a0dad447c2d"
                };
                firebase.initializeApp(config);
                const db = firebase.firestore();
                db.settings({ experimentalForceLongPolling: true }); // Anti-blocage réseau
                
                screenLog("LIAISON_CLOUD_OK");

                db.collection("files").onSnapshot(snap => {
                    const list = document.getElementById('file-list');
                    if(list) {
                        list.innerHTML = '';
                        if(snap.empty) list.innerHTML = "SYSTEME_VIDE";
                        snap.forEach(doc => {
                            const f = doc.data();
                            list.innerHTML += `<div class="p-1 border-b border-green-900/30 font-bold">> ${f.name || 'DATA'}</div>`;
                        });
                        screenLog("FILESYSTEM_SYNC_COMPLETE");
                    }
                }, err => screenLog("ERROR_FIRESTORE: " + err.code, "#F00"));

            } catch(e) {
                screenLog("CRITICAL_FIREBASE_ERR", "#F00");
            }
        }

        // 4. NETWORK (Isolé)
        async function initNet() {
            try {
                const res = await fetch('https://ipapi.co');
                const data = await res.json();
                document.getElementById('ip-external').innerText = data.ip;
                document.getElementById('geo-city').innerText = data.city.toUpperCase();
                document.getElementById('header-loc').innerText = data.city.toUpperCase();
                screenLog("NETWORK_LIAISON_ESTABLISHED");
            } catch(e) {
                screenLog("NETWORK_FAILED_OFFLINE_MODE", "#FFA500");
            }
        }

        // 5. BOOTSTRAP
        window.onload = () => {
            screenLog("BOOTING_NEXUS_v8.5...");
            initMatrix();
            initFirebase();
            initNet();

            // Horloge & Hardware
            setInterval(() => {
                const now = new Date();
                document.getElementById('system-clock').innerText = `21 JANVIER 2026 // ${now.toLocaleTimeString()}`;
                document.getElementById('cpu-usage').innerText = Math.floor(Math.random()*40+20) + "%";
                document.getElementById('cpu-cores').innerText = navigator.hardwareConcurrency || 8;
            }, 1000);
        };
    </script>
</body>
</html>







